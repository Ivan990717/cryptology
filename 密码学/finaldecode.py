from DES import *
from RSA1 import *
import DES_BOX
import gmpy2
from gmpy2 import mpz
import binascii
import re
import codecs
import chardet
from RC4 import *
import base64
"""
 bob接收到alice的文件后要用自己的私钥将密钥解出
 然后再把文件解密
 """
n = 14408712615684604702090555181342454422741112949172920463586775164467917662967597228661204576143178140128983889949486408285418302793304304803905079724977744042377605596020818768204164635491160641780295534819217289221541361028461055322187415411162314639819726499752547389991359274865944756361548533695525228213307624020373872946756443005089550631376730597206247036226130580756581665775523466022522729266447360812287103300071780058120458915612730213385269127710222256391473418084764789585016043424715091229234353109729496933222038288355327540273694513271073267712144770874063415212501236279812804603833939637527796182857
d = 11355130524358430560653874818895815890653112006940857776573992762781924889100057397590580800900908869514652180418863756582164037149527453720983407199530807395833171701836874555445148467184147349232780014073621535220015689067213277771035226378316237034307478741157202307067362311797554278904454867758769656632865747661336175436775504850890804759986084637755176326380016890311959046739945462039163605161803106811034154543085281698314835029646923525106387274659351736854054756099837478213476286175992495047104931945810032605573367129229856835085633841048773774397944724173377006855805401290720480898003678302820936152833


print("------------------------------综合设计解密------------------------------")
message = codecs.open('D:\\密码学课程设计\\finalkey.txt', 'r',
                      encoding=u'utf-8', errors='ignore')
text = message.read()
key = int(text)
message.close()

key = decrypt(d, n, key)
print("密钥为", key)
print("------------------------------解锁密钥成功------------------------------")
message = codecs.open('D:\\密码学课程设计\\encode.txt', 'r',
                      encoding=u'utf-8', errors='ignore')
text = message.read()
message.close()
s = RC4Decrypt(text, key)
try:
    text = open('D:\密码学课程设计\decode.txt', 'w', encoding='utf-8')
    text.write(s)
    text.close()
    print("------------------------------解密文件成功------------------------------")
except IOError:
    print('文件加解密出错！！！')
